{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "password",
  "title": "PasswordField",
  "description": "A password field component for BuzzForm. Supports show/hide toggle, strength indicator, requirements checklist, password generation, and copy-to-clipboard.",
  "dependencies": [
    "@buildnbuzz/buzzform"
  ],
  "registryDependencies": [
    "@buzzform/init",
    "@buzzform/copy",
    "input",
    "button",
    "field"
  ],
  "files": [
    {
      "path": "registry/base/fields/password.tsx",
      "content": "\"use client\";\r\n\r\nimport React, { useState } from \"react\";\r\nimport type {\r\n  PasswordField as PasswordFieldType,\r\n  FormAdapter,\r\n} from \"@buildnbuzz/buzzform\";\r\nimport { getFieldWidthStyle } from \"@buildnbuzz/buzzform\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { CopyButton } from \"@/components/buzzform/copy\";\r\nimport {\r\n  Field,\r\n  FieldContent,\r\n  FieldDescription,\r\n  FieldError,\r\n  FieldLabel,\r\n} from \"@/components/ui/field\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { IconPlaceholder } from \"@/components/icon-placeholder\";\r\n\r\ninterface PasswordCriteria {\r\n  minLength?: number;\r\n  maxLength?: number;\r\n  requireUppercase?: boolean;\r\n  requireLowercase?: boolean;\r\n  requireNumber?: boolean;\r\n  requireSpecial?: boolean;\r\n}\r\n\r\ninterface PasswordStrengthResult {\r\n  score: number;\r\n  label: \"none\" | \"weak\" | \"fair\" | \"strong\" | \"excellent\";\r\n  allMet: boolean;\r\n  checks: {\r\n    minLength: boolean;\r\n    maxLength: boolean;\r\n    hasUppercase: boolean;\r\n    hasLowercase: boolean;\r\n    hasNumber: boolean;\r\n    hasSpecial: boolean;\r\n  };\r\n}\r\n\r\nfunction calculatePasswordStrength(\r\n  password: string,\r\n  criteria: PasswordCriteria = {}\r\n): PasswordStrengthResult {\r\n  const {\r\n    minLength = 8,\r\n    maxLength,\r\n    requireUppercase = false,\r\n    requireLowercase = false,\r\n    requireNumber = false,\r\n    requireSpecial = false,\r\n  } = criteria;\r\n\r\n  const checks = {\r\n    minLength: password.length >= minLength,\r\n    maxLength: maxLength ? password.length <= maxLength : true,\r\n    hasUppercase: /[A-Z]/.test(password),\r\n    hasLowercase: /[a-z]/.test(password),\r\n    hasNumber: /[0-9]/.test(password),\r\n    hasSpecial: /[^A-Za-z0-9]/.test(password),\r\n  };\r\n\r\n  const requiredChecks = [\r\n    { met: checks.minLength, isRequired: true },\r\n    { met: checks.maxLength, isRequired: maxLength !== undefined },\r\n    { met: checks.hasUppercase, isRequired: requireUppercase },\r\n    { met: checks.hasLowercase, isRequired: requireLowercase },\r\n    { met: checks.hasNumber, isRequired: requireNumber },\r\n    { met: checks.hasSpecial, isRequired: requireSpecial },\r\n  ].filter((c) => c.isRequired);\r\n\r\n  const metRequiredCount = requiredChecks.filter((c) => c.met).length;\r\n  const allMet = metRequiredCount === requiredChecks.length;\r\n\r\n  if (!password) {\r\n    return { score: 0, label: \"none\", allMet: false, checks };\r\n  }\r\n\r\n  const varietyCount = [\r\n    checks.hasUppercase,\r\n    checks.hasLowercase,\r\n    checks.hasNumber,\r\n    checks.hasSpecial,\r\n  ].filter(Boolean).length;\r\n\r\n  let score = 0;\r\n\r\n  if (password.length < 4) {\r\n    score = 0;\r\n  } else if (password.length < minLength) {\r\n    score = 1;\r\n  } else {\r\n    score = Math.min(varietyCount, 4);\r\n    if (password.length >= 16) score = Math.min(score + 1, 4);\r\n  }\r\n\r\n  if (!allMet) {\r\n    score = Math.min(score, 2);\r\n  }\r\n\r\n  const labels: Record<number, PasswordStrengthResult[\"label\"]> = {\r\n    0: \"none\",\r\n    1: \"weak\",\r\n    2: \"fair\",\r\n    3: \"strong\",\r\n    4: \"excellent\",\r\n  };\r\n\r\n  return { score, label: labels[score] || \"none\", allMet, checks };\r\n}\r\n\r\nfunction generateStrongPassword(criteria: PasswordCriteria = {}): string {\r\n  const {\r\n    minLength = 16,\r\n    requireUppercase = true,\r\n    requireLowercase = true,\r\n    requireNumber = true,\r\n    requireSpecial = true,\r\n  } = criteria;\r\n\r\n  const uppercaseChars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\r\n  const lowercaseChars = \"abcdefghijklmnopqrstuvwxyz\";\r\n  const numberChars = \"0123456789\";\r\n  const specialChars = \"!@#$%^&*()_+-=[]{}|;:,.<>?\";\r\n\r\n  let allChars = \"\";\r\n  let password = \"\";\r\n\r\n  if (requireUppercase) {\r\n    allChars += uppercaseChars;\r\n    password +=\r\n      uppercaseChars[Math.floor(Math.random() * uppercaseChars.length)];\r\n  }\r\n  if (requireLowercase) {\r\n    allChars += lowercaseChars;\r\n    password +=\r\n      lowercaseChars[Math.floor(Math.random() * lowercaseChars.length)];\r\n  }\r\n  if (requireNumber) {\r\n    allChars += numberChars;\r\n    password += numberChars[Math.floor(Math.random() * numberChars.length)];\r\n  }\r\n  if (requireSpecial) {\r\n    allChars += specialChars;\r\n    password += specialChars[Math.floor(Math.random() * specialChars.length)];\r\n  }\r\n\r\n  if (!allChars) {\r\n    allChars = lowercaseChars + uppercaseChars + numberChars;\r\n  }\r\n\r\n  const targetLength = Math.max(minLength, 12);\r\n  const remainingLength = Math.max(0, targetLength - password.length);\r\n\r\n  for (let i = 0; i < remainingLength; i++) {\r\n    password += allChars[Math.floor(Math.random() * allChars.length)];\r\n  }\r\n\r\n  return password\r\n    .split(\"\")\r\n    .sort(() => 0.5 - Math.random())\r\n    .join(\"\");\r\n}\r\n\r\nconst strengthLabels: Record<PasswordStrengthResult[\"label\"], string> = {\r\n  none: \"\",\r\n  weak: \"Weak\",\r\n  fair: \"Fair\",\r\n  strong: \"Strong\",\r\n  excellent: \"Excellent\",\r\n};\r\n\r\nfunction getStrengthColor(score: number, allMet: boolean): string {\r\n  if (allMet && score >= 3) return \"bg-green-500\";\r\n  if (score >= 3) return \"bg-emerald-500\";\r\n  if (score === 2) return \"bg-orange-500\";\r\n  if (score === 1) return \"bg-red-500\";\r\n  return \"bg-muted\";\r\n}\r\n\r\nfunction getStrengthTextColor(score: number, allMet: boolean): string {\r\n  if (allMet && score >= 3) return \"text-green-600 dark:text-green-400\";\r\n  if (score >= 3) return \"text-emerald-600 dark:text-emerald-400\";\r\n  if (score === 2) return \"text-orange-600 dark:text-orange-400\";\r\n  if (score === 1) return \"text-red-600 dark:text-red-400\";\r\n  return \"text-muted-foreground\";\r\n}\r\n\r\nexport interface PasswordFieldProps {\r\n  field: PasswordFieldType;\r\n  path: string;\r\n  form: FormAdapter;\r\n  autoFocus?: boolean;\r\n  formValues: Record<string, unknown>;\r\n  siblingData: Record<string, unknown>;\r\n  // Computed props\r\n  fieldId: string;\r\n  label: React.ReactNode | null;\r\n  isDisabled: boolean;\r\n  isReadOnly: boolean;\r\n  error?: string;\r\n}\r\n\r\nexport function PasswordField({\r\n  field,\r\n  path,\r\n  form,\r\n  autoFocus,\r\n  fieldId,\r\n  label,\r\n  isDisabled,\r\n  isReadOnly,\r\n  error,\r\n}: PasswordFieldProps) {\r\n  const [showPassword, setShowPassword] = useState(false);\r\n  const value = form.watch<string>(path) ?? \"\";\r\n  const hasError = !!error;\r\n\r\n  // Password criteria from field config\r\n  const criteria = field.criteria ?? {};\r\n\r\n  // Calculate strength once\r\n  const strength = calculatePasswordStrength(value, {\r\n    minLength: field.minLength ?? 8,\r\n    maxLength: field.maxLength,\r\n    ...criteria,\r\n  });\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    form.setValue(path, e.target.value, {\r\n      shouldDirty: true,\r\n    });\r\n  };\r\n\r\n  const handleBlur = () => {\r\n    form.onBlur?.(path);\r\n  };\r\n\r\n  const togglePasswordVisibility = () => {\r\n    setShowPassword(!showPassword);\r\n  };\r\n\r\n  const handleGenerate = () => {\r\n    const generated = generateStrongPassword({\r\n      minLength: field.minLength ?? 16,\r\n      maxLength: field.maxLength,\r\n      ...criteria,\r\n    });\r\n    form.setValue(path, generated, { shouldDirty: true });\r\n    setShowPassword(true); // Show password after generating\r\n  };\r\n\r\n  // Build requirements list based on calculated strength\r\n  const requirements = [\r\n    {\r\n      key: \"minLength\",\r\n      label: `At least ${field.minLength ?? 8} characters`,\r\n      met: strength.checks.minLength,\r\n    },\r\n    ...(field.maxLength\r\n      ? [\r\n          {\r\n            key: \"maxLength\",\r\n            label: `At most ${field.maxLength} characters`,\r\n            met: strength.checks.maxLength,\r\n          },\r\n        ]\r\n      : []),\r\n    ...(criteria.requireUppercase\r\n      ? [\r\n          {\r\n            key: \"uppercase\",\r\n            label: \"One uppercase letter\",\r\n            met: strength.checks.hasUppercase,\r\n          },\r\n        ]\r\n      : []),\r\n    ...(criteria.requireLowercase\r\n      ? [\r\n          {\r\n            key: \"lowercase\",\r\n            label: \"One lowercase letter\",\r\n            met: strength.checks.hasLowercase,\r\n          },\r\n        ]\r\n      : []),\r\n    ...(criteria.requireNumber\r\n      ? [\r\n          {\r\n            key: \"number\",\r\n            label: \"One number\",\r\n            met: strength.checks.hasNumber,\r\n          },\r\n        ]\r\n      : []),\r\n    ...(criteria.requireSpecial\r\n      ? [\r\n          {\r\n            key: \"special\",\r\n            label: \"One special character\",\r\n            met: strength.checks.hasSpecial,\r\n          },\r\n        ]\r\n      : []),\r\n  ];\r\n\r\n  return (\r\n    <Field\r\n      className={field.style?.className}\r\n      data-invalid={hasError}\r\n      data-disabled={isDisabled}\r\n      style={getFieldWidthStyle(field.style)}\r\n    >\r\n      {label && (\r\n        <FieldLabel htmlFor={fieldId} className=\"gap-1 items-baseline\">\r\n          {label}\r\n          {field.required && <span className=\"text-destructive\">*</span>}\r\n        </FieldLabel>\r\n      )}\r\n\r\n      <FieldContent>\r\n        <div className=\"space-y-2\">\r\n          {/* Input with show/hide and generate buttons */}\r\n          <div className=\"relative\">\r\n            <Input\r\n              id={fieldId}\r\n              name={path}\r\n              type={showPassword ? \"text\" : \"password\"}\r\n              value={value}\r\n              onChange={handleChange}\r\n              onBlur={handleBlur}\r\n              placeholder={field.placeholder}\r\n              disabled={isDisabled}\r\n              readOnly={isReadOnly}\r\n              autoComplete={field.autoComplete ?? \"new-password\"}\r\n              aria-invalid={hasError}\r\n              aria-describedby={\r\n                field.ui?.showRequirements\r\n                  ? `${fieldId}-requirements`\r\n                  : field.description\r\n                    ? `${fieldId}-description`\r\n                    : undefined\r\n              }\r\n              minLength={field.minLength}\r\n              maxLength={field.maxLength}\r\n              required={field.required}\r\n              autoFocus={autoFocus}\r\n              className={cn(\r\n                \"pr-20\",\r\n                field.ui?.allowGenerate && \"pr-28\",\r\n                field.ui?.copyable && \"pr-36\"\r\n              )}\r\n            />\r\n            <div className=\"absolute right-0 top-0 h-full flex items-center gap-0.5 pr-1\">\r\n              {/* Copy button */}\r\n              {field.ui?.copyable && value && (\r\n                <CopyButton\r\n                  value={value}\r\n                  disabled={isDisabled}\r\n                  className=\"h-7 w-7 text-muted-foreground hover:text-foreground\"\r\n                />\r\n              )}\r\n              {/* Generate button */}\r\n              {field.ui?.allowGenerate && (\r\n                <Button\r\n                  type=\"button\"\r\n                  variant=\"ghost\"\r\n                  size=\"icon-xs\"\r\n                  onClick={handleGenerate}\r\n                  disabled={isDisabled || isReadOnly}\r\n                  aria-label=\"Generate password\"\r\n                  title=\"Generate strong password\"\r\n                >\r\n                  <IconPlaceholder\r\n                    lucide=\"Sparkles\"\r\n                    hugeicons=\"MagicWand01Icon\"\r\n                    tabler=\"IconWand\"\r\n                    phosphor=\"MagicWand\"\r\n                    remixicon=\"RiMagicLine\"\r\n                    className=\"size-3.5\"\r\n                  />\r\n                </Button>\r\n              )}\r\n              {/* Show/hide button */}\r\n              <Button\r\n                type=\"button\"\r\n                variant=\"ghost\"\r\n                size=\"icon-xs\"\r\n                onClick={togglePasswordVisibility}\r\n                disabled={isDisabled}\r\n                aria-label={showPassword ? \"Hide password\" : \"Show password\"}\r\n              >\r\n                {showPassword ? (\r\n                  <IconPlaceholder\r\n                    lucide=\"EyeOff\"\r\n                    hugeicons=\"ViewOffSlashIcon\"\r\n                    tabler=\"IconEyeOff\"\r\n                    phosphor=\"EyeSlash\"\r\n                    remixicon=\"RiEyeOffLine\"\r\n                    className=\"size-3.5\"\r\n                  />\r\n                ) : (\r\n                  <IconPlaceholder\r\n                    lucide=\"Eye\"\r\n                    hugeicons=\"ViewIcon\"\r\n                    tabler=\"IconEye\"\r\n                    phosphor=\"Eye\"\r\n                    remixicon=\"RiEyeLine\"\r\n                    className=\"size-3.5\"\r\n                  />\r\n                )}\r\n              </Button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Strength indicator bar */}\r\n          {field.ui?.strengthIndicator && value && (\r\n            <div className=\"flex items-center gap-2\">\r\n              <div className=\"flex gap-1 h-1 flex-1\">\r\n                {[0, 1, 2, 3].map((idx) => (\r\n                  <div\r\n                    key={idx}\r\n                    className={cn(\r\n                      \"h-full flex-1 rounded-full transition-colors\",\r\n                      idx < strength.score\r\n                        ? getStrengthColor(strength.score, strength.allMet)\r\n                        : \"bg-muted\"\r\n                    )}\r\n                  />\r\n                ))}\r\n              </div>\r\n              {strength.label !== \"none\" && (\r\n                <span\r\n                  className={cn(\r\n                    \"text-xs font-medium transition-colors\",\r\n                    getStrengthTextColor(strength.score, strength.allMet)\r\n                  )}\r\n                >\r\n                  {strengthLabels[strength.label]}\r\n                </span>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* Requirements checklist */}\r\n          {field.ui?.showRequirements && requirements.length > 0 && (\r\n            <div\r\n              id={`${fieldId}-requirements`}\r\n              className=\"text-xs space-y-1\"\r\n              role=\"list\"\r\n              aria-label=\"Password requirements\"\r\n            >\r\n              {requirements.map((req) => (\r\n                <div\r\n                  key={req.key}\r\n                  className={cn(\r\n                    \"flex items-center gap-1.5 transition-colors\",\r\n                    value\r\n                      ? req.met\r\n                        ? \"text-green-600 dark:text-green-400\"\r\n                        : \"text-muted-foreground\"\r\n                      : \"text-muted-foreground\"\r\n                  )}\r\n                  role=\"listitem\"\r\n                >\r\n                  {value ? (\r\n                    req.met ? (\r\n                      <IconPlaceholder\r\n                        lucide=\"Check\"\r\n                        hugeicons=\"Tick01Icon\"\r\n                        tabler=\"IconCheck\"\r\n                        phosphor=\"Check\"\r\n                        remixicon=\"RiCheckLine\"\r\n                        className=\"size-3 text-green-500\"\r\n                      />\r\n                    ) : (\r\n                      <IconPlaceholder\r\n                        lucide=\"X\"\r\n                        hugeicons=\"Cancel01Icon\"\r\n                        tabler=\"IconX\"\r\n                        phosphor=\"X\"\r\n                        remixicon=\"RiCloseLine\"\r\n                        className=\"size-3 text-muted-foreground\"\r\n                      />\r\n                    )\r\n                  ) : (\r\n                    <span className=\"size-3 rounded-full border border-muted-foreground/50\" />\r\n                  )}\r\n                  <span>{req.label}</span>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </FieldContent>\r\n\r\n      {field.description && (\r\n        <FieldDescription id={`${fieldId}-description`}>\r\n          {field.description}\r\n        </FieldDescription>\r\n      )}\r\n\r\n      {error && <FieldError>{error}</FieldError>}\r\n    </Field>\r\n  );\r\n}\r\n\r\nexport function PasswordFieldSkeleton({ field }: { field: PasswordFieldType }) {\r\n  const label = field.label !== false ? (field.label ?? field.name) : null;\r\n  const showStrengthBar = field.ui?.strengthIndicator;\r\n  const showRequirements = field.ui?.showRequirements;\r\n\r\n  const requirementCount = [\r\n    true, // minLength always\r\n    !!field.maxLength,\r\n    !!field.criteria?.requireUppercase,\r\n    !!field.criteria?.requireLowercase,\r\n    !!field.criteria?.requireNumber,\r\n    !!field.criteria?.requireSpecial,\r\n  ].filter(Boolean).length;\r\n\r\n  return (\r\n    <Field\r\n      className={field.style?.className}\r\n      style={\r\n        field.style?.width\r\n          ? {\r\n              width:\r\n                typeof field.style.width === \"number\"\r\n                  ? `${field.style.width}px`\r\n                  : field.style.width,\r\n            }\r\n          : undefined\r\n      }\r\n    >\r\n      {label && <div className=\"h-4 w-24 animate-pulse rounded bg-muted\" />}\r\n      <FieldContent>\r\n        <div className=\"space-y-2\">\r\n          <div className=\"h-8 w-full animate-pulse rounded-lg bg-muted\" />\r\n          {showStrengthBar && (\r\n            <div className=\"h-1 w-full animate-pulse rounded-full bg-muted\" />\r\n          )}\r\n          {showRequirements && (\r\n            <div className=\"space-y-1\">\r\n              {Array.from({ length: requirementCount }).map((_, i) => (\r\n                <div\r\n                  key={i}\r\n                  className=\"h-3 w-32 animate-pulse rounded bg-muted\"\r\n                />\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </FieldContent>\r\n      {field.description && (\r\n        <div className=\"h-3 w-48 animate-pulse rounded bg-muted\" />\r\n      )}\r\n    </Field>\r\n  );\r\n}\r\n",
      "type": "registry:component",
      "target": "components/buzzform/fields/password.tsx"
    }
  ],
  "type": "registry:ui"
}