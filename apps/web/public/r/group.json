{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "group",
  "title": "GroupField",
  "description": "A container field for BuzzForm that groups nested fields into named objects. Supports multiple visual variants (card, flat, ghost, bordered) with collapse/expand functionality, error badge display, and nested field validation.",
  "dependencies": [
    "@buildnbuzz/buzzform"
  ],
  "registryDependencies": [
    "@buzzform/init",
    "card",
    "collapsible",
    "badge",
    "skeleton"
  ],
  "files": [
    {
      "path": "registry/base/fields/group.tsx",
      "content": "\"use client\";\r\n\r\nimport * as React from \"react\";\r\nimport { getNestedFieldPaths } from \"@buildnbuzz/buzzform\";\r\nimport type {\r\n  Field,\r\n  GroupField as GroupFieldType,\r\n  FormAdapter,\r\n} from \"@buildnbuzz/buzzform\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { FieldRenderer, type FieldRegistry } from \"./render\";\r\nimport { Skeleton } from \"@/components/ui/skeleton\";\r\nimport { Card, CardContent, CardHeader } from \"@/components/ui/card\";\r\nimport {\r\n  Collapsible,\r\n  CollapsibleContent,\r\n  CollapsibleTrigger,\r\n} from \"@/components/ui/collapsible\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { IconPlaceholder } from \"@/components/icon-placeholder\";\r\n\r\nexport interface GroupFieldComponentProps {\r\n  field: GroupFieldType;\r\n  path: string;\r\n  form: FormAdapter;\r\n  registry?: FieldRegistry;\r\n  autoFocus?: boolean;\r\n  // Computed props\r\n  fieldId: string;\r\n  label: React.ReactNode | null;\r\n  isDisabled: boolean;\r\n  isReadOnly: boolean;\r\n  error?: string;\r\n}\r\n\r\n/**\r\n * Count errors in nested fields\r\n */\r\nconst useNestedErrors = (\r\n  form: FormAdapter,\r\n  fields: Field[],\r\n  basePath: string\r\n): number => {\r\n  const errors = form.formState.errors;\r\n\r\n  const nestedPaths = getNestedFieldPaths(fields, basePath);\r\n  let errorCount = 0;\r\n\r\n  for (const fieldPath of nestedPaths) {\r\n    const error = errors[fieldPath];\r\n    if (error) {\r\n      errorCount++;\r\n    }\r\n  }\r\n\r\n  return errorCount;\r\n};\r\n\r\n/**\r\n * Spacing class map\r\n */\r\nconst spacingMap = {\r\n  sm: \"space-y-3\",\r\n  md: \"space-y-4\",\r\n  lg: \"space-y-6\",\r\n} as const;\r\n\r\nexport const GroupField = React.forwardRef<\r\n  HTMLDivElement,\r\n  GroupFieldComponentProps\r\n>(({ field, path, form, registry, label }: GroupFieldComponentProps, ref) => {\r\n  // Extract UI options with defaults\r\n  const variant = field.ui?.variant ?? \"card\";\r\n  const spacing = field.ui?.spacing ?? \"md\";\r\n  const collapsed = field.ui?.collapsed ?? false;\r\n  const showErrorBadge = field.ui?.showErrorBadge !== false;\r\n\r\n  const [isCollapsed, setIsCollapsed] = React.useState(collapsed);\r\n\r\n  // Count nested errors for badge\r\n  const errorCount = useNestedErrors(form, field.fields, path);\r\n\r\n  // Render nested fields\r\n  const renderNestedFields = () => (\r\n    <div className={cn(spacingMap[spacing])}>\r\n      {field.fields.map((f, i) => {\r\n        const nestedPath = \"name\" in f ? `${path}.${f.name}` : path;\r\n        return (\r\n          <FieldRenderer\r\n            key={i}\r\n            field={f}\r\n            path={nestedPath}\r\n            form={form}\r\n            registry={registry}\r\n          />\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n\r\n  // Render description if provided\r\n  const renderDescription = () => {\r\n    if (!field.description) return null;\r\n\r\n    return (\r\n      <p className=\"text-sm text-muted-foreground mb-3\">{field.description}</p>\r\n    );\r\n  };\r\n\r\n  // === FLAT VARIANT ===\r\n  // No container, just grouped fields with optional label\r\n  if (variant === \"flat\") {\r\n    return (\r\n      <div\r\n        ref={ref}\r\n        className={cn(\"w-full\", field.style?.className)}\r\n        style={field.style?.width ? { width: field.style.width } : undefined}\r\n      >\r\n        {label && (\r\n          <div className=\"flex items-center gap-2 mb-1\">\r\n            <span className=\"font-medium text-sm text-foreground\">{label}</span>\r\n            {showErrorBadge && errorCount > 0 && (\r\n              <div className=\"inline-flex items-center gap-1 text-xs text-destructive font-medium\">\r\n                <IconPlaceholder\r\n                  lucide=\"AlertCircle\"\r\n                  hugeicons=\"AlertCircleIcon\"\r\n                  tabler=\"IconAlertCircle\"\r\n                  phosphor=\"Warning\"\r\n                  className=\"size-3.5\"\r\n                />\r\n                {errorCount} {errorCount === 1 ? \"error\" : \"errors\"}\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n        {renderDescription()}\r\n        {renderNestedFields()}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // === GHOST VARIANT ===\r\n  // Minimal styling, subtle border, no header background\r\n  if (variant === \"ghost\") {\r\n    return (\r\n      <div\r\n        ref={ref}\r\n        className={cn(\r\n          \"border border-border/50 rounded-lg p-4\",\r\n          field.style?.className\r\n        )}\r\n        style={field.style?.width ? { width: field.style.width } : undefined}\r\n      >\r\n        {label && (\r\n          <div className=\"flex items-center gap-2 mb-1\">\r\n            <span className=\"font-medium text-sm text-foreground\">{label}</span>\r\n            {showErrorBadge && errorCount > 0 && (\r\n              <Badge variant=\"destructive\" className=\"h-5 px-1.5 text-xs\">\r\n                {errorCount}\r\n              </Badge>\r\n            )}\r\n          </div>\r\n        )}\r\n        {renderDescription()}\r\n        {renderNestedFields()}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // === BORDERED VARIANT ===\r\n  // Dashed border with optional collapse support\r\n  if (variant === \"bordered\") {\r\n    return (\r\n      <Collapsible\r\n        open={!isCollapsed}\r\n        onOpenChange={(open) => setIsCollapsed(!open)}\r\n      >\r\n        <div\r\n          ref={ref}\r\n          className={cn(\r\n            \"border border-dashed border-border rounded-lg overflow-hidden\",\r\n            field.style?.className\r\n          )}\r\n          style={field.style?.width ? { width: field.style.width } : undefined}\r\n        >\r\n          {label && (\r\n            <CollapsibleTrigger\r\n              className=\"w-full px-4 py-2 flex flex-row items-center justify-between hover:bg-muted/50 transition-colors select-none cursor-pointer\"\r\n              onClick={() => setIsCollapsed(!isCollapsed)}\r\n              aria-expanded={!isCollapsed}\r\n              aria-label={`${isCollapsed ? \"Expand\" : \"Collapse\"} ${label}`}\r\n            >\r\n              <div className=\"flex items-center gap-2\">\r\n                <span className=\"font-medium text-muted-foreground text-sm\">\r\n                  {label}\r\n                </span>\r\n                {showErrorBadge && errorCount > 0 && (\r\n                  <Badge variant=\"destructive\" className=\"h-5 px-1.5 text-xs\">\r\n                    {errorCount}\r\n                  </Badge>\r\n                )}\r\n              </div>\r\n              <IconPlaceholder\r\n                lucide=\"ChevronDown\"\r\n                hugeicons=\"ArrowDown01Icon\"\r\n                tabler=\"IconChevronDown\"\r\n                phosphor=\"CaretDown\"\r\n                className={cn(\r\n                  \"size-3.5 text-muted-foreground transition-transform duration-200 shrink-0\",\r\n                  isCollapsed && \"-rotate-90\"\r\n                )}\r\n              />\r\n            </CollapsibleTrigger>\r\n          )}\r\n          <CollapsibleContent>\r\n            <div className=\"px-4 pt-2 pb-4\">\r\n              {renderDescription()}\r\n              {renderNestedFields()}\r\n            </div>\r\n          </CollapsibleContent>\r\n        </div>\r\n      </Collapsible>\r\n    );\r\n  }\r\n\r\n  // === CARD VARIANT (DEFAULT) ===\r\n  // Full card with header background and border\r\n  return (\r\n    <Collapsible\r\n      open={!isCollapsed}\r\n      onOpenChange={(open) => setIsCollapsed(!open)}\r\n    >\r\n      <Card\r\n        ref={ref}\r\n        className={cn(\"py-0 gap-0\", field.style?.className)}\r\n        style={field.style?.width ? { width: field.style.width } : undefined}\r\n      >\r\n        {label && (\r\n          <CardHeader className=\"p-0 border-b-0\">\r\n            <CollapsibleTrigger\r\n              className={cn(\r\n                \"w-full px-4 py-3 flex flex-row items-center justify-between\",\r\n                \"hover:bg-muted/75 bg-muted/50 transition-colors select-none cursor-pointer\",\r\n                !isCollapsed && \"border-b\"\r\n              )}\r\n              onClick={() => setIsCollapsed(!isCollapsed)}\r\n              aria-expanded={!isCollapsed}\r\n              aria-label={`${isCollapsed ? \"Expand\" : \"Collapse\"} ${label}`}\r\n            >\r\n              <div className=\"flex items-center gap-2\">\r\n                <span className=\"font-semibold text-sm\">{label}</span>\r\n                {showErrorBadge && errorCount > 0 && (\r\n                  <Badge variant=\"destructive\" className=\"h-5 px-1.5 text-xs\">\r\n                    {errorCount}\r\n                  </Badge>\r\n                )}\r\n              </div>\r\n              <IconPlaceholder\r\n                lucide=\"ChevronDown\"\r\n                hugeicons=\"ArrowDown01Icon\"\r\n                tabler=\"IconChevronDown\"\r\n                phosphor=\"CaretDown\"\r\n                className={cn(\r\n                  \"size-4 text-muted-foreground transition-transform duration-200 shrink-0\",\r\n                  isCollapsed && \"-rotate-90\"\r\n                )}\r\n              />\r\n            </CollapsibleTrigger>\r\n          </CardHeader>\r\n        )}\r\n\r\n        <CollapsibleContent>\r\n          <CardContent className=\"px-4 pt-3 pb-4\">\r\n            {renderDescription()}\r\n            {renderNestedFields()}\r\n          </CardContent>\r\n        </CollapsibleContent>\r\n      </Card>\r\n    </Collapsible>\r\n  );\r\n});\r\n\r\nGroupField.displayName = \"GroupField\";\r\n\r\n/**\r\n * GroupFieldSkeleton - Loading state for group fields.\r\n * Recursively renders skeletons for nested fields.\r\n */\r\nexport const GroupFieldSkeleton = React.forwardRef<\r\n  HTMLDivElement,\r\n  { field: GroupFieldType }\r\n>(({ field }: { field: GroupFieldType }, ref) => {\r\n  const variant = field.ui?.variant ?? \"card\";\r\n  const spacing = field.ui?.spacing ?? \"md\";\r\n  const label = field.label !== false ? field.label || field.name : null;\r\n\r\n  // Estimate nested field heights for skeleton\r\n  const getSkeletonHeight = (nestedField: Field) => {\r\n    switch (nestedField.type) {\r\n      case \"textarea\":\r\n        return \"h-24\";\r\n      case \"upload\":\r\n        return \"h-32\";\r\n      case \"checkbox\":\r\n      case \"switch\":\r\n        return \"h-6\";\r\n      case \"group\":\r\n      case \"array\":\r\n        return \"h-40\";\r\n      default:\r\n        return \"h-9\";\r\n    }\r\n  };\r\n\r\n  const renderNestedSkeletons = () => (\r\n    <div className={cn(spacingMap[spacing])}>\r\n      {field.fields.slice(0, 3).map((f, i) => (\r\n        <div key={i} className=\"space-y-2\">\r\n          {\"label\" in f && f.label !== false && (\r\n            <Skeleton className=\"h-4 w-20\" />\r\n          )}\r\n          <Skeleton className={cn(\"w-full rounded-md\", getSkeletonHeight(f))} />\r\n        </div>\r\n      ))}\r\n      {field.fields.length > 3 && (\r\n        <div className=\"text-xs text-muted-foreground\">\r\n          +{field.fields.length - 3} more fields...\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n\r\n  // Flat variant skeleton\r\n  if (variant === \"flat\") {\r\n    return (\r\n      <div\r\n        ref={ref}\r\n        className={cn(\"w-full\", field.style?.className)}\r\n        style={field.style?.width ? { width: field.style.width } : undefined}\r\n      >\r\n        {label && <Skeleton className=\"h-5 w-32 mb-3\" />}\r\n        {renderNestedSkeletons()}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Ghost variant skeleton\r\n  if (variant === \"ghost\") {\r\n    return (\r\n      <div\r\n        ref={ref}\r\n        className={cn(\r\n          \"border border-border/50 rounded-lg p-4\",\r\n          field.style?.className\r\n        )}\r\n        style={field.style?.width ? { width: field.style.width } : undefined}\r\n      >\r\n        {label && <Skeleton className=\"h-5 w-32 mb-1\" />}\r\n        {renderNestedSkeletons()}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Bordered variant skeleton\r\n  if (variant === \"bordered\") {\r\n    return (\r\n      <div\r\n        ref={ref}\r\n        className={cn(\r\n          \"border border-dashed border-border rounded-lg overflow-hidden\",\r\n          field.style?.className\r\n        )}\r\n        style={field.style?.width ? { width: field.style.width } : undefined}\r\n      >\r\n        <div className=\"px-4 py-2 flex items-center justify-between\">\r\n          <Skeleton className=\"h-4 w-28\" />\r\n          <Skeleton className=\"h-4 w-4\" />\r\n        </div>\r\n        <div className=\"px-4 pb-4\">{renderNestedSkeletons()}</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Card variant skeleton (default)\r\n  return (\r\n    <Card ref={ref} className={cn(\"py-0\", field.style?.className)}>\r\n      <CardHeader className=\"px-4 py-3 bg-muted/50 border-b flex flex-row justify-between items-center\">\r\n        <Skeleton className=\"h-5 w-32\" />\r\n        <Skeleton className=\"h-4 w-4\" />\r\n      </CardHeader>\r\n      <CardContent className=\"pt-4 px-4 pb-4\">\r\n        {renderNestedSkeletons()}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n});\r\n\r\nGroupFieldSkeleton.displayName = \"GroupFieldSkeleton\";\r\n",
      "type": "registry:component",
      "target": "components/buzzform/fields/group.tsx"
    }
  ],
  "type": "registry:ui"
}