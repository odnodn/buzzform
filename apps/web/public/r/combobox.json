{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "combobox",
  "title": "Combobox",
  "description": "A searchable combobox component built with Popover and Command. Includes single-select Combobox and multi-select MultiCombobox variants.",
  "registryDependencies": [
    "popover",
    "command",
    "badge",
    "button"
  ],
  "files": [
    {
      "path": "registry/base/combobox.tsx",
      "content": "\"use client\";\r\n\r\nimport * as React from \"react\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n  Command,\r\n  CommandEmpty,\r\n  CommandGroup,\r\n  CommandInput,\r\n  CommandItem,\r\n  CommandList,\r\n} from \"@/components/ui/command\";\r\nimport {\r\n  Popover,\r\n  PopoverContent,\r\n  PopoverTrigger,\r\n} from \"@/components/ui/popover\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { IconPlaceholder } from \"@/components/icon-placeholder\";\r\n\r\ntype TriggerAdapterProps = {\r\n  children: React.ReactElement<{ children?: React.ReactNode }>;\r\n  render?: React.ReactElement;\r\n};\r\n\r\nfunction PopoverTriggerAdapter({ children, render }: TriggerAdapterProps) {\r\n  // We cast to a shared type to support both Radix (asChild) and Base UI (render) patterns\r\n  const Trigger = PopoverTrigger as React.ComponentType<{\r\n    render?: React.ReactElement;\r\n    asChild?: boolean;\r\n    children?: React.ReactNode;\r\n  }>;\r\n\r\n  if (render) {\r\n    return (\r\n      <Trigger render={render}>\r\n        {React.isValidElement(children) ? children.props.children : children}\r\n      </Trigger>\r\n    );\r\n  }\r\n\r\n  return <Trigger asChild>{children}</Trigger>;\r\n}\r\n\r\nexport interface ComboboxOption {\r\n  value: string;\r\n  label: string;\r\n  description?: string;\r\n  icon?: React.ReactNode;\r\n  disabled?: boolean;\r\n}\r\n\r\nexport interface ComboboxProps {\r\n  options: ComboboxOption[];\r\n  value?: string;\r\n  onValueChange?: (value: string | undefined) => void;\r\n  placeholder?: string;\r\n  searchPlaceholder?: string;\r\n  emptyMessage?: string;\r\n  loadingMessage?: string;\r\n  isLoading?: boolean;\r\n  disabled?: boolean;\r\n  readOnly?: boolean;\r\n  className?: string;\r\n  triggerClassName?: string;\r\n  contentClassName?: string;\r\n  showDescriptions?: boolean;\r\n  isClearable?: boolean;\r\n  \"aria-invalid\"?: boolean;\r\n  id?: string;\r\n  autoFocus?: boolean;\r\n}\r\n\r\nexport function Combobox({\r\n  options,\r\n  value,\r\n  onValueChange,\r\n  placeholder = \"Select an option...\",\r\n  searchPlaceholder = \"Search...\",\r\n  emptyMessage = \"No results found.\",\r\n  loadingMessage = \"Loading...\",\r\n  isLoading = false,\r\n  disabled = false,\r\n  readOnly = false,\r\n  className,\r\n  triggerClassName,\r\n  contentClassName,\r\n  showDescriptions = false,\r\n  isClearable = true,\r\n  \"aria-invalid\": ariaInvalid,\r\n  id,\r\n  autoFocus,\r\n}: ComboboxProps) {\r\n  const [open, setOpen] = React.useState(false);\r\n  const listboxId = React.useId();\r\n\r\n  const selectedOption = React.useMemo(\r\n    () => options.find((opt) => opt.value === value),\r\n    [options, value]\r\n  );\r\n\r\n  const handleSelect = React.useCallback(\r\n    (currentValue: string) => {\r\n      const newValue = currentValue === value ? undefined : currentValue;\r\n      onValueChange?.(newValue);\r\n      setOpen(false);\r\n    },\r\n    [value, onValueChange]\r\n  );\r\n\r\n  const handleClear = React.useCallback(\r\n    (e: React.MouseEvent) => {\r\n      e.stopPropagation();\r\n      onValueChange?.(undefined);\r\n    },\r\n    [onValueChange]\r\n  );\r\n\r\n  return (\r\n    <Popover open={open} onOpenChange={setOpen}>\r\n      <PopoverTriggerAdapter\r\n        render={\r\n          <Button\r\n            id={id}\r\n            type=\"button\"\r\n            variant=\"outline\"\r\n            role=\"combobox\"\r\n            aria-expanded={open}\r\n            aria-controls={listboxId}\r\n            aria-haspopup=\"listbox\"\r\n            aria-invalid={ariaInvalid}\r\n            disabled={disabled || readOnly}\r\n            autoFocus={autoFocus}\r\n            className={cn(\r\n              \"w-full justify-between font-normal\",\r\n              !value && \"text-muted-foreground\",\r\n              ariaInvalid && \"border-destructive\",\r\n              triggerClassName\r\n            )}\r\n          />\r\n        }\r\n      >\r\n        <Button\r\n          id={id}\r\n          type=\"button\"\r\n          variant=\"outline\"\r\n          role=\"combobox\"\r\n          aria-expanded={open}\r\n          aria-controls={listboxId}\r\n          aria-haspopup=\"listbox\"\r\n          aria-invalid={ariaInvalid}\r\n          disabled={disabled || readOnly}\r\n          autoFocus={autoFocus}\r\n          className={cn(\r\n            \"w-full justify-between font-normal\",\r\n            !value && \"text-muted-foreground\",\r\n            ariaInvalid && \"border-destructive\",\r\n            triggerClassName\r\n          )}\r\n        >\r\n          <span className=\"flex items-center gap-2 truncate flex-1 min-w-0\">\r\n            {selectedOption?.icon && (\r\n              <span className=\"shrink-0\">{selectedOption.icon}</span>\r\n            )}\r\n            <span className=\"truncate\">\r\n              {selectedOption?.label ?? placeholder}\r\n            </span>\r\n          </span>\r\n          <div className=\"flex items-center gap-0.5 shrink-0\">\r\n            {isClearable && value && !disabled && !readOnly && (\r\n              <span\r\n                onClick={handleClear}\r\n                className=\"p-0.5 rounded-sm hover:bg-muted cursor-pointer\"\r\n                aria-label=\"Clear selection\"\r\n              >\r\n                <IconPlaceholder\r\n                  lucide=\"X\"\r\n                  hugeicons=\"Cancel01Icon\"\r\n                  tabler=\"IconX\"\r\n                  phosphor=\"X\"\r\n                  className=\"size-3.5 opacity-50 hover:opacity-100\"\r\n                />\r\n              </span>\r\n            )}\r\n            <IconPlaceholder\r\n              lucide=\"ChevronsUpDown\"\r\n              hugeicons=\"UnfoldMoreIcon\"\r\n              tabler=\"IconSelector\"\r\n              phosphor=\"CaretUpDown\"\r\n              className=\"size-4 opacity-50\"\r\n            />\r\n          </div>\r\n        </Button>\r\n      </PopoverTriggerAdapter>\r\n      <PopoverContent\r\n        className={cn(\"w-(--anchor-width) p-0\", contentClassName)}\r\n        align=\"start\"\r\n      >\r\n        <Command className={className}>\r\n          <CommandInput placeholder={searchPlaceholder} />\r\n          <CommandList id={listboxId} role=\"listbox\">\r\n            {isLoading ? (\r\n              <div className=\"py-6 text-center text-sm text-muted-foreground\">\r\n                {loadingMessage}\r\n              </div>\r\n            ) : (\r\n              <>\r\n                <CommandEmpty>{emptyMessage}</CommandEmpty>\r\n                <CommandGroup>\r\n                  {options.map((option) => (\r\n                    <CommandItem\r\n                      key={option.value}\r\n                      value={option.value}\r\n                      keywords={[option.label, option.description ?? \"\"].filter(\r\n                        Boolean\r\n                      )}\r\n                      onSelect={handleSelect}\r\n                      disabled={option.disabled}\r\n                      data-checked={value === option.value}\r\n                    >\r\n                      <div className=\"flex items-center gap-2 flex-1 min-w-0\">\r\n                        {option.icon && (\r\n                          <span className=\"shrink-0\">{option.icon}</span>\r\n                        )}\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <div\r\n                            className={cn(\r\n                              \"truncate\",\r\n                              option.disabled && \"opacity-50\"\r\n                            )}\r\n                          >\r\n                            {option.label}\r\n                          </div>\r\n                          {showDescriptions && option.description && (\r\n                            <div className=\"text-xs text-muted-foreground truncate\">\r\n                              {option.description}\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    </CommandItem>\r\n                  ))}\r\n                </CommandGroup>\r\n              </>\r\n            )}\r\n          </CommandList>\r\n        </Command>\r\n      </PopoverContent>\r\n    </Popover>\r\n  );\r\n}\r\n\r\nexport interface MultiComboboxProps {\r\n  options: ComboboxOption[];\r\n  value?: string[];\r\n  onValueChange?: (value: string[]) => void;\r\n  placeholder?: string;\r\n  searchPlaceholder?: string;\r\n  emptyMessage?: string;\r\n  loadingMessage?: string;\r\n  isLoading?: boolean;\r\n  disabled?: boolean;\r\n  readOnly?: boolean;\r\n  className?: string;\r\n  triggerClassName?: string;\r\n  contentClassName?: string;\r\n  showDescriptions?: boolean;\r\n  maxVisibleChips?: number;\r\n  \"aria-invalid\"?: boolean;\r\n  id?: string;\r\n}\r\n\r\nexport function MultiCombobox({\r\n  options,\r\n  value = [],\r\n  onValueChange,\r\n  placeholder = \"Select options...\",\r\n  searchPlaceholder = \"Search...\",\r\n  emptyMessage = \"No results found.\",\r\n  loadingMessage = \"Loading...\",\r\n  isLoading = false,\r\n  disabled = false,\r\n  readOnly = false,\r\n  className,\r\n  triggerClassName,\r\n  contentClassName,\r\n  showDescriptions = false,\r\n  maxVisibleChips = 3,\r\n  \"aria-invalid\": ariaInvalid,\r\n  id,\r\n}: MultiComboboxProps) {\r\n  const [open, setOpen] = React.useState(false);\r\n  const listboxId = React.useId();\r\n\r\n  const selectedOptions = React.useMemo(\r\n    () => options.filter((opt) => value.includes(opt.value)),\r\n    [options, value]\r\n  );\r\n\r\n  const visibleChips = selectedOptions.slice(0, maxVisibleChips);\r\n  const hiddenCount = Math.max(0, selectedOptions.length - maxVisibleChips);\r\n\r\n  const handleSelect = React.useCallback(\r\n    (selectedValue: string) => {\r\n      const exists = value.includes(selectedValue);\r\n      const newValue = exists\r\n        ? value.filter((v) => v !== selectedValue)\r\n        : [...value, selectedValue];\r\n      onValueChange?.(newValue);\r\n    },\r\n    [value, onValueChange]\r\n  );\r\n\r\n  const handleRemove = React.useCallback(\r\n    (e: React.MouseEvent, valueToRemove: string) => {\r\n      e.stopPropagation();\r\n      onValueChange?.(value.filter((v) => v !== valueToRemove));\r\n    },\r\n    [value, onValueChange]\r\n  );\r\n\r\n  const handleClearAll = React.useCallback(\r\n    (e: React.MouseEvent) => {\r\n      e.stopPropagation();\r\n      onValueChange?.([]);\r\n    },\r\n    [onValueChange]\r\n  );\r\n\r\n  return (\r\n    <Popover open={open} onOpenChange={setOpen}>\r\n      <PopoverTriggerAdapter\r\n        render={\r\n          <button\r\n            id={id}\r\n            type=\"button\"\r\n            role=\"combobox\"\r\n            aria-expanded={open}\r\n            aria-controls={listboxId}\r\n            aria-haspopup=\"listbox\"\r\n            aria-invalid={ariaInvalid}\r\n            disabled={disabled || readOnly}\r\n            className={cn(\r\n              \"border-input data-placeholder:text-muted-foreground dark:bg-input/30 dark:hover:bg-input/50 focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:aria-invalid:border-destructive/50 flex min-h-8 w-full items-center justify-between gap-2 rounded-lg border bg-transparent px-2 py-1.5 text-sm transition-colors select-none focus-visible:ring-[3px] aria-invalid:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50\",\r\n              ariaInvalid && \"border-destructive\",\r\n              triggerClassName\r\n            )}\r\n          />\r\n        }\r\n      >\r\n        <button\r\n          id={id}\r\n          type=\"button\"\r\n          role=\"combobox\"\r\n          aria-expanded={open}\r\n          aria-controls={listboxId}\r\n          aria-haspopup=\"listbox\"\r\n          aria-invalid={ariaInvalid}\r\n          disabled={disabled || readOnly}\r\n          className={cn(\r\n            \"border-input data-placeholder:text-muted-foreground dark:bg-input/30 dark:hover:bg-input/50 focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:aria-invalid:border-destructive/50 flex min-h-8 w-full items-center justify-between gap-2 rounded-lg border bg-transparent px-2 py-1.5 text-sm transition-colors select-none focus-visible:ring-[3px] aria-invalid:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50\",\r\n            ariaInvalid && \"border-destructive\",\r\n            triggerClassName\r\n          )}\r\n        >\r\n          <div className=\"flex flex-wrap items-center gap-1 flex-1 min-w-0\">\r\n            {selectedOptions.length === 0 ? (\r\n              <span className=\"text-muted-foreground px-0.5\">\r\n                {placeholder}\r\n              </span>\r\n            ) : (\r\n              <>\r\n                {visibleChips.map((option) => (\r\n                  <Badge\r\n                    key={option.value}\r\n                    variant=\"secondary\"\r\n                    className=\"gap-1 pr-1 shrink-0\"\r\n                  >\r\n                    {option.label}\r\n                    {!disabled && !readOnly && (\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          handleRemove(e, option.value);\r\n                        }}\r\n                        className=\"ml-0.5 rounded-full hover:bg-foreground/10 p-0.5\"\r\n                        aria-label={`Remove ${option.label}`}\r\n                      >\r\n                        <IconPlaceholder\r\n                          lucide=\"X\"\r\n                          hugeicons=\"Cancel01Icon\"\r\n                          tabler=\"IconX\"\r\n                          phosphor=\"X\"\r\n                          className=\"size-3\"\r\n                        />\r\n                      </button>\r\n                    )}\r\n                  </Badge>\r\n                ))}\r\n                {hiddenCount > 0 && (\r\n                  <Badge\r\n                    variant=\"outline\"\r\n                    className=\"pointer-events-none shrink-0\"\r\n                  >\r\n                    +{hiddenCount}\r\n                  </Badge>\r\n                )}\r\n              </>\r\n            )}\r\n          </div>\r\n          <div className=\"flex items-center gap-0.5 shrink-0\">\r\n            {value.length > 0 && !disabled && !readOnly && (\r\n              <span\r\n                onClick={handleClearAll}\r\n                className=\"p-0.5 rounded-sm hover:bg-muted cursor-pointer\"\r\n                aria-label=\"Clear all\"\r\n              >\r\n                <IconPlaceholder\r\n                  lucide=\"X\"\r\n                  hugeicons=\"Cancel01Icon\"\r\n                  tabler=\"IconX\"\r\n                  phosphor=\"X\"\r\n                  className=\"size-3.5 opacity-50 hover:opacity-100\"\r\n                />\r\n              </span>\r\n            )}\r\n            <IconPlaceholder\r\n              lucide=\"ChevronsUpDown\"\r\n              hugeicons=\"UnfoldMoreIcon\"\r\n              tabler=\"IconSelector\"\r\n              phosphor=\"CaretUpDown\"\r\n              className=\"size-4 opacity-50\"\r\n            />\r\n          </div>\r\n        </button>\r\n      </PopoverTriggerAdapter>\r\n      <PopoverContent\r\n        className={cn(\"w-(--anchor-width) p-0\", contentClassName)}\r\n        align=\"start\"\r\n      >\r\n        <Command className={className}>\r\n          <CommandInput placeholder={searchPlaceholder} />\r\n          <CommandList id={listboxId} role=\"listbox\">\r\n            {isLoading ? (\r\n              <div className=\"py-6 text-center text-sm text-muted-foreground\">\r\n                {loadingMessage}\r\n              </div>\r\n            ) : (\r\n              <>\r\n                <CommandEmpty>{emptyMessage}</CommandEmpty>\r\n                <CommandGroup>\r\n                  {options.map((option) => {\r\n                    const isSelected = value.includes(option.value);\r\n                    return (\r\n                      <CommandItem\r\n                        key={option.value}\r\n                        value={option.value}\r\n                        keywords={[\r\n                          option.label,\r\n                          option.description ?? \"\",\r\n                        ].filter(Boolean)}\r\n                        onSelect={handleSelect}\r\n                        disabled={option.disabled}\r\n                        data-checked={isSelected}\r\n                      >\r\n                        <div className=\"flex items-center gap-2 flex-1 min-w-0\">\r\n                          <div\r\n                            className={cn(\r\n                              \"flex h-4 w-4 shrink-0 items-center justify-center rounded-sm border border-primary\",\r\n                              isSelected\r\n                                ? \"bg-primary text-primary-foreground\"\r\n                                : \"opacity-50\"\r\n                            )}\r\n                          >\r\n                            {isSelected && (\r\n                              <IconPlaceholder\r\n                                lucide=\"Check\"\r\n                                hugeicons=\"Tick01Icon\"\r\n                                tabler=\"IconCheck\"\r\n                                phosphor=\"Check\"\r\n                                className=\"size-3\"\r\n                              />\r\n                            )}\r\n                          </div>\r\n                          {option.icon && (\r\n                            <span className=\"shrink-0\">{option.icon}</span>\r\n                          )}\r\n                          <div className=\"flex-1 min-w-0\">\r\n                            <div\r\n                              className={cn(\r\n                                \"truncate\",\r\n                                option.disabled && \"opacity-50\"\r\n                              )}\r\n                            >\r\n                              {option.label}\r\n                            </div>\r\n                            {showDescriptions && option.description && (\r\n                              <div className=\"text-xs text-muted-foreground truncate\">\r\n                                {option.description}\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                      </CommandItem>\r\n                    );\r\n                  })}\r\n                </CommandGroup>\r\n              </>\r\n            )}\r\n          </CommandList>\r\n        </Command>\r\n      </PopoverContent>\r\n    </Popover>\r\n  );\r\n}\r\n",
      "type": "registry:component",
      "target": "components/buzzform/combobox.tsx"
    }
  ],
  "type": "registry:ui"
}